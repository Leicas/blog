{{- $src := .Get "src" -}}
{{- $text := .Get "text" -}}
{{- if eq $text "" -}}
  {{- errorf "link shortcode missing 'text' parameter: %s" .Position -}}
{{- end -}}
{{- $permalink := 0 }}
{{- if eq (substr $src 0 1) "/" -}}
  {{ $permalink = ref . $src }}
{{- else -}}
  {{ $permalink = relref . $src }}
{{- end -}}
<a href="{{ $permalink }}">{{- $text -}}</a>